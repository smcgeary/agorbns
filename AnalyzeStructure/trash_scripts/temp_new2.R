I_lp_4 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/logp/I_8mer_4.txt",row.names=1,header=TRUE)
I_lp_5 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/logp/I_8mer_5.txt",row.names=1,header=TRUE)
I_lp_6 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/logp/I_8mer_6.txt",row.names=1,header=TRUE)
I_lp_7 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/logp/I_8mer_7.txt",row.names=1,header=TRUE)
I_lp_8 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/logp/I_8mer_8.txt",row.names=1,header=TRUE)
I_lp_9 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/logp/I_8mer_9.txt",row.names=1,header=TRUE)
I_lp_10 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/logp/I_8mer_10.txt",row.names=1,header=TRUE)
I_lp_11 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/logp/I_8mer_11.txt",row.names=1,header=TRUE)
I_lp_12 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/logp/I_8mer_12.txt",row.names=1,header=TRUE)
I_lp_13 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/logp/I_8mer_13.txt",row.names=1,header=TRUE)
I_lp_14 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/logp/I_8mer_14.txt",row.names=1,header=TRUE)
I_lp_15 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/logp/I_8mer_15.txt",row.names=1,header=TRUE)
I_lp_16 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/logp/I_8mer_16.txt",row.names=1,header=TRUE)
I_lp_17 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/logp/I_8mer_17.txt",row.names=1,header=TRUE)
I_lp_18 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/logp/I_8mer_18.txt",row.names=1,header=TRUE)
I_lp_19 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/logp/I_8mer_19.txt",row.names=1,header=TRUE)
I_lp_20 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/logp/I_8mer_20.txt",row.names=1,header=TRUE)



I_p_4 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/p/I_8mer_4.txt",row.names=1,header=TRUE)
I_p_5 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/p/I_8mer_5.txt",row.names=1,header=TRUE)
I_p_6 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/p/I_8mer_6.txt",row.names=1,header=TRUE)
I_p_7 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/p/I_8mer_7.txt",row.names=1,header=TRUE)
I_p_8 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/p/I_8mer_8.txt",row.names=1,header=TRUE)
I_p_9 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/p/I_8mer_9.txt",row.names=1,header=TRUE)
I_p_10 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/p/I_8mer_10.txt",row.names=1,header=TRUE)
I_p_11 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/p/I_8mer_11.txt",row.names=1,header=TRUE)
I_p_12 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/p/I_8mer_12.txt",row.names=1,header=TRUE)
I_p_13 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/p/I_8mer_13.txt",row.names=1,header=TRUE)
I_p_14 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/p/I_8mer_14.txt",row.names=1,header=TRUE)
I_p_15 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/p/I_8mer_15.txt",row.names=1,header=TRUE)
I_p_16 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/p/I_8mer_16.txt",row.names=1,header=TRUE)
I_p_17 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/p/I_8mer_17.txt",row.names=1,header=TRUE)
I_p_18 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/p/I_8mer_18.txt",row.names=1,header=TRUE)
I_p_19 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/p/I_8mer_19.txt",row.names=1,header=TRUE)
I_p_20 <- read.table("/lab/solexa_bartel/mcgeary/AgoRBNS/let-7a/equilibrium/4ntflank_5p_unpaired_probs/p/I_8mer_20.txt",row.names=1,header=TRUE)


par(lwd=2)
par(mfrow=c(2,2))
log_mins <- rep(0,20)
log_pos <-rep(0,20)
flank_data_full <- data.frame(I_lp_1,log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t)))
x <- 1:(length(colnames(flank_data_full))-1)
plot(x,sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}),type="l",xlim=c(0,15),ylim=c(-1,0))
title(main="log prob averages",col.txt="blue")
legend("topright",legend=seq(1,20),col=rainbow(20),lwd=2,cex=0.9)
sapply(1:12,function(i) { text(x=i,-1.0,labels=seed_string[i],cex=2)})
sapply(1:20,function(n) {
	name = paste0("I_lp_",n)

		flank_data_full <- data.frame(eval(as.name(name)),log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t)))
	x <- 1:(length(colnames(flank_data_full))-1)
	print(x)
	y <- sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)})
	log_mins[n] <<- min(y)
	log_pos[n] <<- (x-0.5*(n-1)%%2)[which(y == min(y))]
	lines((x-0.5*(n-1)%%2),y,col=rainbow(20)[n],lwd=2)

})

flank_data_full <- data.frame(data.frame(log10(I_p),log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t))))
x <- 1:(length(colnames(flank_data_full))-1)
plot(x,sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}),type="l",xlim=c(0,15),ylim=c(-1,0))
title(main="prob averages",col="red")
legend("topright",legend=seq(1,20),col=rainbow(20),lwd=2,cex=0.9)

prob_mins <- rep(0,20)
prob_pos <-rep(0,20)

sapply(1:12,function(i) { text(x=i,-1.0,labels=seed_string[i],cex=2)})
sapply(1:20,function(n) {
	name = paste0("I_p_",n)

		flank_data_full <- data.frame(log10(eval(as.name(name))),log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t)))
	x <- 1:(length(colnames(flank_data_full))-1)
	print(x)
	y <- sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)})
	prob_mins[n] <<- min(y)
	prob_pos[n] <<- (x-0.5*(n-1)%%2)[which(y == min(y))]
	lines((x-0.5*(n-1)%%2),y,col=rainbow(20)[n],lwd=2)

})
plot(1:20,log_pos,type="l",col="blue",ylim=c(1,13))
lines(1:20,prob_pos,col="red",lty=2)
plot(1:20,log_mins,type="l",col="blue",ylim=c(-1,0.5))
lines(1:20,prob_mins,col="red",lty=2)

break

	flank_data_full <- data.frame(data.frame(I_lp,log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t))))
	x <- 1:(length(colnames(flank_data_full))-1)
	print(sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}))
lines(x,sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}),lty=2)

flank_data_full <- data.frame(data.frame(log10(I_p_2),log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t))))
x <- 1:(length(colnames(flank_data_full))-1)
print(sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}))
lines(x,sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}),col="red")

flank_data_full <- data.frame(data.frame(I_lp_2,log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t))))
x <- 1:(length(colnames(flank_data_full))-1)
print(sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}))
lines(x,sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}),lty=2,col="red")

flank_data_full <- data.frame(data.frame(log10(I_p_3),log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t))))
x <- 1:(length(colnames(flank_data_full))-1)
print(sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}))
lines(x,sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}),col="blue")

flank_data_full <- data.frame(data.frame(I_lp_3,log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t))))
x <- 1:(length(colnames(flank_data_full))-1)
print(sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}))
lines(x,sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}),lty=2,col="blue")

flank_data_full <- data.frame(data.frame(log10(I_p_4),log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t))))
x <- 1:(length(colnames(flank_data_full))-1)
print(sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}))
lines(x,sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}),col="deeppink")

flank_data_full <- data.frame(data.frame(I_lp_4,log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t))))
x <- 1:(length(colnames(flank_data_full))-1)
print(sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}))
lines(x,sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}),lty=2,col="deeppink")

flank_data_full <- data.frame(data.frame(log10(I_p_5),log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t))))
x <- 1:(length(colnames(flank_data_full))-1)
print(sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}))
lines(x,sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}),col=rainbow(20)[5])

flank_data_full <- data.frame(data.frame(I_lp_5,log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t))))
x <- 1:(length(colnames(flank_data_full))-1)
print(sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}))
lines(x,sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}),lty=2,col=rainbow(20)[5])


flank_data_full <- data.frame(data.frame(log10(I_p_6),log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t))))
x <- 1:(length(colnames(flank_data_full))-1)
print(sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}))
lines(x,sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}),col=rainbow(20)[10])

flank_data_full <- data.frame(data.frame(I_lp_6,log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t))))
x <- 1:(length(colnames(flank_data_full))-1)
print(sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}))
lines(x,sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}),lty=2,col=rainbow(20)[10])




break

flank_data_full <- data.frame(data.frame(log10(I_p_3),log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t))))
x <- 1:(length(colnames(flank_data_full))-1)
print(sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}))
lines(x,sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}),col="blue")

flank_data_full <- data.frame(data.frame(I_lp_3,log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t))))
x <- 1:(length(colnames(flank_data_full))-1)
print(sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}))
lines(x,sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}),lty=2,col="blue")



flank_data_full <- data.frame(data.frame(log10(I_p_3),log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t))))
x <- 1:(length(colnames(flank_data_full))-1)
print(sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}))
lines(x,sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}),col="blue")

flank_data_full <- data.frame(data.frame(I_lp_3,log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t))))
x <- 1:(length(colnames(flank_data_full))-1)
print(sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}))
lines(x,sapply(x,function(col){cor(flank_data_full[,col],flank_data_full$total)}),lty=2,col="blue")





flank_data_full <- data.frame(data.frame(log10(I_p_2),log10(I_t_7mer_m8/sum(I_t_7mer_m8))-log10(A0.4_t/sum(A0.4_t))))


plot(x,y,type="l",xlim=c(-3,3),ylim=c(-0.8,-0.6),type="l")
col_choice <- rainbow(13,end=0.66)
names(col_choice) <- colnames(flank_data_full)[1:13]
sapply(colnames(flank_data_full)[1:13], function(name){
	y = sapply(x,function(i){cor(i*flank_data_full[,name],flank_data_full$total)})
	print(cbind(x,y))
	lines(x,sapply(x,function(i){cor(i*flank_data_full[,name],flank_data_full$total)}),
	col=col_choice[name],lwd=2)
})

